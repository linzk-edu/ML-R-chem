# 清空环境
rm(list=ls())
 
# 安装包并加载包
# 使用k-means聚类所需的包：factoextra和cluster 
site="https://mirrors.tuna.tsinghua.edu.cn/CRAN"
package_list = c("factoextra","cluster")
for(p in package_list){
  if(!suppressWarnings(suppressMessages(require(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))){
    install.packages(p, repos=site)
    suppressWarnings(suppressMessages(library(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))
  }
}
 
# 数据准备
library(readxl)
data <- read_excel("C:/Users/ZhuanZ/Desktop/PMI-ML-/raw-rgb.xlsx") 
# 进行标准化
df = scale(data)
# 获取桌面路径（自动适配系统）
desktop_path <- file.path(Sys.getenv("USERPROFILE"), "Desktop")  
# 构建完整文件路径
file_path <- file.path(desktop_path, "rgb-scale.csv")  
# 导出数据（不包含行号）
write.csv(df, file = file_path, row.names = FALSE)  